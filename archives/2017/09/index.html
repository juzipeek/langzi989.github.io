
<!DOCTYPE html>
<html lang="zh-CN">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="魏传柳">
    <title>Archives: 2017/9 - 魏传柳</title>
    <meta name="author" content="魏传柳(langzi989)">
    
        <meta name="keywords" content="hexo,javascript,">
    
    
    
        <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <meta property="og:type" content="blog">
<meta property="og:title" content="魏传柳">
<meta property="og:url" content="http://yoursite.com/archives/2017/09/index.html">
<meta property="og:site_name" content="魏传柳">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="魏传柳">
    
    
        
    
    
        <meta property="og:image" content="http://yoursite.com/assets/images/avar.jpg"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-nuvue6sithwirecbhvw3dkaobiojqvtadsnhguwi7k04xklybw5djl1smadp.min.css">
    <!--STYLES END-->
    
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <h1 class="header-title">
        <a class="header-title-link" href="/ ">魏传柳</a>
    </h1>
    
        
            <a  class="header-right-picture "
                href="#about">
        
        
            <img class="header-picture" src="/assets/images/avar.jpg"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="1">
    
        <div class="sidebar-profile">
            <a href="/#about">
                    <img class="sidebar-profile-picture" src="/assets/images/avar.jpg"/>
            </a>
            <span class="sidebar-profile-name">魏传柳(langzi989)</span>
        </div>
    
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/ "
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-home"></i>
                    <span class="sidebar-button-desc">home</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/all-categories"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
                    <span class="sidebar-button-desc">categories</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/all-tags"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
                    <span class="sidebar-button-desc">tags</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/all-archives"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
                    <span class="sidebar-button-desc">archives</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link st-search-show-outputs"
                         href="#search"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-search"></i>
                    <span class="sidebar-button-desc">search</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="#about"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-question"></i>
                    <span class="sidebar-button-desc">about</span>
                </a>
        </li>
        
    </ul>
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="https://github.com/langzi989" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-github"></i>
                    <span class="sidebar-button-desc">GitHub</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="http://blog.csdn.net/u014630623" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-csdn"></i>
                    <span class="sidebar-button-desc">CSDN</span>
                </a>
        </li>
        
    </ul>
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/atom.xml"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
                    <span class="sidebar-button-desc">RSS</span>
                </a>
        </li>
        
    </ul>
    
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
    

<section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2017/09/09/Linux中ulimit命令简单使用/">
                            Linux中ulimit命令简单使用
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2017-09-09T10:05:01+08:00">
	
		    9月 09, 2017
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/linux笔记/">linux笔记</a>


    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <h1 id="linux中ulimit命令简单使用"><a href="#linux中ulimit命令简单使用" class="headerlink" title="linux中ulimit命令简单使用"></a>linux中ulimit命令简单使用</h1><blockquote>
<p>系统性能是一个受关注的话题，如何通过最简单的设置来实现有效的性能调优，如何在有限资源的条件下保证程序的运作，ulimit是我们在处理问题的时候经常使用的一种手段。ulimit是一种linux系统内置的功能。下面将列举ulimit的一些常用关键字和简单用法。</p>
</blockquote>
<h2 id="ulimit命令参数"><a href="#ulimit命令参数" class="headerlink" title="ulimit命令参数"></a>ulimit命令参数</h2><p>ulimit参数命令</p>
<blockquote>
<p>注意ulimit设置分软硬区别，加-H为硬,-S为软.默认查询是显示的是软，但使用ulimit进行设置的时候为软硬都作用。</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">示例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-H</td>
<td style="text-align:left">设置硬资源限制，一旦设置不能增加。</td>
<td style="text-align:left">ulimit – Hs 64；限制硬资源，线程栈大小为 64K。</td>
</tr>
<tr>
<td style="text-align:left">-S</td>
<td style="text-align:left">设置软资源限制，设置后可以增加，但是不能超过硬资源设置。</td>
<td style="text-align:left">ulimit – Sn 32；限制软资源，32 个文件描述符。</td>
</tr>
<tr>
<td style="text-align:left">-a</td>
<td style="text-align:left">显示当前所有的 limit 信息。</td>
<td style="text-align:left">ulimit – a；显示当前所有的 limit 信息。</td>
</tr>
<tr>
<td style="text-align:left">-c</td>
<td style="text-align:left">最大的 core 文件的大小， 以 blocks 为单位。</td>
<td style="text-align:left">ulimit – c unlimited； 对生成的 core 文件的大小不进行限制。</td>
</tr>
<tr>
<td style="text-align:left">-d</td>
<td style="text-align:left">进程最大的数据段的大小，以 Kbytes 为单位。</td>
<td style="text-align:left">ulimit -d unlimited；对进程的数据段大小不进行限制。</td>
</tr>
<tr>
<td style="text-align:left">-f</td>
<td style="text-align:left">进程可以创建文件的最大值，以 blocks 为单位。</td>
<td style="text-align:left">ulimit – f 2048；限制进程可以创建的最大文件大小为 2048 blocks。</td>
</tr>
<tr>
<td style="text-align:left">-l</td>
<td style="text-align:left">最大可加锁内存大小，以 Kbytes 为单位。</td>
<td style="text-align:left">ulimit – l 32；限制最大可加锁内存大小为 32 Kbytes。</td>
</tr>
<tr>
<td style="text-align:left">-m</td>
<td style="text-align:left">最大内存大小，以 Kbytes 为单位。</td>
<td style="text-align:left">ulimit – m unlimited；对最大内存不进行限制。</td>
</tr>
<tr>
<td style="text-align:left">-n</td>
<td style="text-align:left">可以打开最大文件描述符的数量。</td>
<td style="text-align:left">ulimit – n 128；限制最大可以使用 128 个文件描述符。</td>
</tr>
<tr>
<td style="text-align:left">-p</td>
<td style="text-align:left">管道缓冲区的大小，以 Kbytes 为单位。</td>
<td style="text-align:left">ulimit – p 512；限制管道缓冲区的大小为 512 Kbytes。</td>
</tr>
<tr>
<td style="text-align:left">-s</td>
<td style="text-align:left">线程栈大小，以 Kbytes 为单位。</td>
<td style="text-align:left">ulimit – s 512；限制线程栈的大小为 512 Kbytes。</td>
</tr>
<tr>
<td style="text-align:left">-t</td>
<td style="text-align:left">最大的 CPU 占用时间，以秒为单位。</td>
<td style="text-align:left">ulimit – t unlimited；对最大的 CPU 占用时间不进行限制。</td>
</tr>
<tr>
<td style="text-align:left">-u</td>
<td style="text-align:left">用户最大可用的进程数。</td>
<td style="text-align:left">ulimit – u 64；限制用户最多可以使用 64 个进程。</td>
</tr>
<tr>
<td style="text-align:left">-v</td>
<td style="text-align:left">进程最大可用的虚拟内存，以 Kbytes 为单位。</td>
<td style="text-align:left">ulimit – v 200000；限制最大可用的虚拟内存为 200000 Kbytes。</td>
</tr>
</tbody>
</table>
<h2 id="ulimit参数作用范围"><a href="#ulimit参数作用范围" class="headerlink" title="ulimit参数作用范围"></a>ulimit参数作用范围</h2><ul>
<li>针对单个tty生效:在tty中直接运行ulimit命令的作用范围是只对当前tty生效</li>
<li>针对单个用户生效:将命令添加到.bashrc中,将对当前用户生效</li>
<li>针对所有用户生效:将命令添加到/etc/security/limits.conf中，可以设置针对特定用户或者所有用户的限制。</li>
</ul>

                    
                        
                    
                    
                        <p>
                            <a href="/2017/09/09/Linux中ulimit命令简单使用/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2017/09/08/C++函数指针学习/">
                            C++函数指针学习
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2017-09-08T17:47:20+08:00">
	
		    9月 08, 2017
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/C-problems/">C++ problems</a>


    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <h1 id="C-函数指针学习"><a href="#C-函数指针学习" class="headerlink" title="C++函数指针学习"></a>C++函数指针学习</h1><h2 id="使用函数指针的优点"><a href="#使用函数指针的优点" class="headerlink" title="使用函数指针的优点"></a>使用函数指针的优点</h2><p>使用函数指针有助于我们设计出更优秀，更简洁更高效的程序。在下面的情景中我们常用到函数指针:</p>
<ul>
<li>使用函数指针作为参数</li>
<li>使用函数指针作为返回值</li>
<li>使用函数指针作为回调函数</li>
<li>使用函数指针数组</li>
<li>类的静态方法和非静态方法的函数指针</li>
<li>使用函数指针实现动态绑定</li>
<li>在结构体中定义函数</li>
</ul>
<h2 id="使用函数指针提高函数的效率"><a href="#使用函数指针提高函数的效率" class="headerlink" title="使用函数指针提高函数的效率"></a>使用函数指针提高函数的效率</h2><p>当通过switch case多用多个相同类型的函数的时候，这个时候使用函数指针可以大大简化函数代码并可以明显的提高程序的执行效率。例:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line">#include &lt;iostream&gt;</div><div class="line">#include &lt;time.h&gt;</div><div class="line">#include &lt;string&gt;</div><div class="line">#include &lt;sys/time.h&gt;</div><div class="line"></div><div class="line">using namespace std;</div><div class="line"></div><div class="line">#define StartTime(id)  struct timeval __now1105##id;\</div><div class="line">                       gettimeofday(&amp;__now1105##id, 0);</div><div class="line">#define EndTime(id) struct timeval __now21105##id; \</div><div class="line">					      gettimeofday(&amp;__now21105##id, 0); \</div><div class="line">						printf(&quot;timer_%s spend time:%d us\n&quot;,#id,(__now21105##id.tv_sec-__now1105##id.tv_sec)* 1000000 + (__now21105##id.tv_usec-__now1105##id.tv_usec));</div><div class="line"></div><div class="line">double add(double a, double b) &#123;</div><div class="line">	return a + b;</div><div class="line">&#125;</div><div class="line"></div><div class="line">double sub(double a, double b) &#123;</div><div class="line">	return a - b;</div><div class="line">&#125;</div><div class="line"></div><div class="line">double multi(double a, double b) &#123;</div><div class="line">	return a * b;</div><div class="line">&#125;</div><div class="line"></div><div class="line">double div(double a, double b) &#123;</div><div class="line">	return a/b;</div><div class="line">&#125;</div><div class="line"></div><div class="line">typedef double (*op)(double, double);</div><div class="line"></div><div class="line">void func1(double a, double b, int flag) &#123;</div><div class="line">	switch(flag) &#123;</div><div class="line">		case 0:</div><div class="line">			add(a, b);</div><div class="line">			break;</div><div class="line">		case 1:</div><div class="line">			sub(a, b);</div><div class="line">			break;</div><div class="line">		case 2:</div><div class="line">			multi(a, b);</div><div class="line">			break;</div><div class="line">		case 3:</div><div class="line">			div(a, b);</div><div class="line">			break;</div><div class="line">		default:</div><div class="line">			break;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">//使用函数指针调用函数</div><div class="line">void func2(double a, double b, op cb) &#123;</div><div class="line">	cb(a, b);</div><div class="line">&#125;</div><div class="line"></div><div class="line">int main() &#123;</div><div class="line">	StartTime(func1);</div><div class="line">		for (int i = 0; i &lt; 100000; i++) &#123;</div><div class="line">			func1(0.2, 0.034, 3);</div><div class="line">		&#125;</div><div class="line">	EndTime(func1);</div><div class="line"></div><div class="line">	StartTime(func2);</div><div class="line">		for (int i = 0; i &lt; 100000; i++) &#123;</div><div class="line">			func2(0.2, 0.034, multi);</div><div class="line">		&#125;</div><div class="line">	EndTime(func2);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>由上面可以看出,由于上述switch,case中调用的函数类型（返回值类型，参数个数以及对应的类型）完全一致，我们将函数指针以参数的形式传到处理函数中。<br>运行上述函数的结果如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">timer_func1 spend time:2861 us</div><div class="line">timer_func2 spend time:2178 us</div></pre></td></tr></table></figure>
<p>可以看出使用函数指针的效率远远高于switch case</p>
<h2 id="函数指针用做回调函数"><a href="#函数指针用做回调函数" class="headerlink" title="函数指针用做回调函数"></a>函数指针用做回调函数</h2><blockquote>
<p>来源于wiki<br>在计算机程序设计中，回调函数是指通过函数参数传递到其他代码的，某一块可执行代码的引用。这一设计允许底层代码调用在高层定义的子程序。如Linux C中的signal函数就是这样一个例子。</p>
</blockquote>
<p>signal底层的其中一个实现版本如下:由其实现可以看出信号处理的回调函数的主要功能是将处理信号的函数指针替换为用户高层自定义的函数地址fun，从而达到当接收到该信号时底层代码调用高层定义代码的效果。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">Sigfunc *</div><div class="line">signal(int signo, Sigfunc *func)</div><div class="line">&#123;</div><div class="line">	struct sigaction	act, oact;</div><div class="line"></div><div class="line">	act.sa_handler = func;</div><div class="line">	sigemptyset(&amp;act.sa_mask);</div><div class="line">	act.sa_flags = 0;</div><div class="line">	if (signo == SIGALRM) &#123;</div><div class="line">#ifdef	SA_INTERRUPT</div><div class="line">		act.sa_flags |= SA_INTERRUPT;</div><div class="line">#endif</div><div class="line">	&#125; else &#123;</div><div class="line">		act.sa_flags |= SA_RESTART;</div><div class="line">	&#125;</div><div class="line">	if (sigaction(signo, &amp;act, &amp;oact) &lt; 0)</div><div class="line">		return(SIG_ERR);</div><div class="line">	return(oact.sa_handler);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>当我们使用signal函数的时候,如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">#include &lt;signal.h&gt;</div><div class="line">#include &lt;stdio.h&gt;</div><div class="line"></div><div class="line">void signalcb(int signum) &#123;</div><div class="line">  printf(&quot;this is the signal:%d&quot;, signum);</div><div class="line">&#125;</div><div class="line"></div><div class="line">int main() &#123;</div><div class="line">  signal(SIGINT, signalcb);</div><div class="line">  pause();</div><div class="line">  return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="函数指针的本质及声明方法以及赋值"><a href="#函数指针的本质及声明方法以及赋值" class="headerlink" title="函数指针的本质及声明方法以及赋值"></a>函数指针的本质及声明方法以及赋值</h2><h3 id="函数指针的本质"><a href="#函数指针的本质" class="headerlink" title="函数指针的本质"></a>函数指针的本质</h3><p>函数指针类似于数据指针，其本质实质上是一类函数（返回值类型相同，参数个数以及对应的参数类型相同）的入口地址，即该<strong>可执行代码在内存中的起始地址</strong>。函数指针可以让我们通过函数地址去调用该函数。有利于实现函数的动态绑定，即在运行时才决定去调用哪个函数。</p>
<h3 id="函数指针的声明方法"><a href="#函数指针的声明方法" class="headerlink" title="函数指针的声明方法"></a>函数指针的声明方法</h3><p>函数指针的声明方法有两种，包括:</p>
<ul>
<li>普通函数的函数指针和类静态成员函数的函数指针</li>
<li>类非静态成员函数的函数指针</li>
</ul>
<p>普通函数的函数指针和类静态成员函数的函数指针:<br>int (<em>funptr)(int  qa, int qb);<br>类非静态成员函数的函数指针：<br>int MyClass::(</em>funptr)(int  qa, int qb);</p>
<p><strong>注意上述函数指针声明时(*funptr)中的括号不能省略，若省略，有可能会产生歧义，其意义就变成了返回值为int*的函数定义了</strong></p>
<blockquote>
<p>上述两种函数指针声明不兼容的原因如下:(《深度探索C++对象模型》)<br>获取类的静态和非静态函数的函数指针的地址都是其在内存中实际的地址。那为什么非静态成员的指针需要绑定(指明类)？原因是类的非静态成员需要操作类的数据成员,所以类的非静态成员需要绑定this指针找到类的数据成员。故对nonstatic函数取地址是不完整的。</p>
</blockquote>
<h3 id="函数指针的赋值与使用"><a href="#函数指针的赋值与使用" class="headerlink" title="函数指针的赋值与使用"></a>函数指针的赋值与使用</h3><h4 id="函数指针赋值"><a href="#函数指针赋值" class="headerlink" title="函数指针赋值"></a>函数指针赋值</h4><p>对于普通指针和类的静态成员指针，有两种赋值方式:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">funptr = fnc1</div><div class="line">funptr = &amp;fun1</div></pre></td></tr></table></figure></p>
<p>对于类的非静态成员指针，只能用上面第二种形式赋值。为了保证形式的一致性和避免二义性，一般<strong>统一使用取地址符号进行赋值</strong>可避免错误出现。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">funptr = &amp;classInstance.func();</div></pre></td></tr></table></figure></p>
<h4 id="函数指针使用"><a href="#函数指针使用" class="headerlink" title="函数指针使用"></a>函数指针使用</h4><p>函数指针的使用类似于赋值。<br>对于普通指针和类的静态成员函数指针的调用，有两种调用方式:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">funptr(1,2);</div><div class="line"></div><div class="line">(*funptr)(1,2);</div></pre></td></tr></table></figure></p>
<p>对于类的静态成员函数，只能用上述第二种方式进行调用，为了保持一致性和避免二义性，一般统一使用<strong>使用*来解引用函数指针进行调用</strong>.</p>
<h2 id="函数指针作为参数"><a href="#函数指针作为参数" class="headerlink" title="函数指针作为参数"></a>函数指针作为参数</h2><p>函数指针是一个类型，将函数指针作为参数传入函数中与其他参数类似。使用方式与上述<strong>函数指针用做回调函数</strong>中signal接收参数的方式相同。这里不再详解</p>
<h3 id="函数指针作为返回值"><a href="#函数指针作为返回值" class="headerlink" title="函数指针作为返回值"></a>函数指针作为返回值</h3><p>既然函数指针是函数的入口地址,所以函数指针也可以作为函数的返回值返回。不过函数指针作为函数的返回值的写反比较复杂。<br>若一个函数func只有一个参数int, 其返回值类型是float (*) (float, float)；则其函数原型如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">float (*func(int op)) (float, float);</div></pre></td></tr></table></figure></p>
<p>函数指针作为函数返回值的原则是,将函数名以及参数写到*后，函数指针的返回值放在最前面，函数指针的参数放在最后面。</p>
<p>由上面的知识我们可以分析一下signal函数原型。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">void (*signal)(int signo,void (*func)(int)))(int);</div></pre></td></tr></table></figure></p>
<p>其定义了一个有两个参数分别为int和void (<em>func)(int)，返回值为void (</em>func)(int)的函数。</p>
<p>其本质上是将函数处理指针替换为用户自定义的函数指针。那为什么需要返回值为void (<em>func)(int)呢?原因是<em>*signal函数的返回值是旧的信号处理函数的指针，我们可以通过这个指针暂时改变signal函数处理信号的方式。之后可以通过返回的指针恢复该信号默认的处理方式。</em></em></p>
<blockquote>
<p>注意:signal的信号处理其函数中的int参数的含义是:当信号到达的时候,内核将该信号以整形的方式传给处理器函数，即为void (*func)(int sig)中的sig.</p>
</blockquote>
<h2 id="使用typedef定义函数指针"><a href="#使用typedef定义函数指针" class="headerlink" title="使用typedef定义函数指针"></a>使用typedef定义函数指针</h2><p>一般情况下，如果通过普通的方式定义函数指针，在使用的很不方便。这个时候我们可以通过typedef定义函数指针的新类型。通过typedef定义新类型时与普通类型定义新类型方式不同。对于普通类型，定义方式如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">typedef int64_t int64;</div></pre></td></tr></table></figure></p>
<p>但是对于函数指针，定义方式如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">//此处定义个名字为func的类型,它表示函数指针float (*func)(float, float)类型</div><div class="line">typedef float (*func)(float, float);</div><div class="line"></div><div class="line">float function(float a, floatb);</div><div class="line"></div><div class="line">//使用func定义变量</div><div class="line">func test = &amp;function;</div></pre></td></tr></table></figure>

                    
                        
                    
                    
                        <p>
                            <a href="/2017/09/08/C++函数指针学习/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2017/09/07/Linux常用命令/">
                            Linux常用命令混淆点记录
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2017-09-07T17:05:01+08:00">
	
		    9月 07, 2017
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/linux笔记/">linux笔记</a>


    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <h1 id="Linux常用命令混淆点记录"><a href="#Linux常用命令混淆点记录" class="headerlink" title="Linux常用命令混淆点记录"></a>Linux常用命令混淆点记录</h1><h2 id="ls命令单位问题"><a href="#ls命令单位问题" class="headerlink" title="ls命令单位问题"></a>ls命令单位问题</h2><p>ls命令的<strong>默认单位为字节</strong>。<br>若使用ls时需要指定单位显示的时候，需要添加参数-h或–block-size进行操作。具体操作方法如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">#-h表示human，即人可读的方式</div><div class="line">#它会按照文件的大小显示单位,</div><div class="line">#若文件小于1k，则不显示单位，表示字节</div><div class="line">#若文件大于1k但是小于1M，显示的单位为k</div><div class="line">#文件大于1M小于1G会显示单位为M，</div><div class="line">#以此类推</div><div class="line">ls -h ~/test</div><div class="line"></div><div class="line">#按照指定的单位显示</div><div class="line">#注意使用此参数需要注意一个问题。若文件小于1G也显示1G。</div><div class="line">ls --block-size=g ~/test    #按照单位为g显示</div></pre></td></tr></table></figure>

                    
                        
                    
                    
                        <p>
                            <a href="/2017/09/07/Linux常用命令/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">page 1 of 1</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2017 魏传柳(langzi989). All Rights Reserved.
    </span>
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
     </script>
   </br></br>本文总阅读量<span id="busuanzi_value_page_pv"></span>次
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/avar.jpg"/>
        
            <h4 id="about-card-name">魏传柳(langzi989)</h4>
        
            <h5 id="about-card-bio"><p>author.bio</p>
</h5>
        
        
            <h5 id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </h5>
        
        
            <h5 id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br/>
                Guangzhou,China
            </h5>
        
    </div>
</div>

        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
    </body>
    <!--SCRIPTS-->
<script src="/assets/js/script-i4qo6jx6jji9fg0dftpya6ivemizsbow4fhow76d8dwpm7m1wbvi378ssumx.min.js"></script>
<!--SCRIPTS END-->



</html>
